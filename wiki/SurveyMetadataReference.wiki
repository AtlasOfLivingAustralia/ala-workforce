#summary Describes the XML structure of a survey question set.

== Introduction ==

Add your content here.


== Question set structure ==

A survey is defined as metadata in XML.  This metadata consists of a set of question definitions and other survey related data. An overview of the syntax of a question set is shown below. More detailed descriptions of metadata elements come after that. Optional elements are surrounds by square brackets.

{{{
<?xml version="1.0" encoding="UTF-8"?>
<questionSet>
  <title>...</title>
  <shortName>...</shortName>
  [<requiredRole>...</requiredRole>]
  <pageSequence>
    ...
  </pageSequence>
  [<knownQuestions>
    ...
  </knownQuestions>]
  [<accounts>
      ...
  </accounts>]
  <question>
    ...
  </question>
  ...
</questionSet>
}}}

==== Title, Short Name ====

The title and shortName text elements define the title and short title of the survey.  For example,

{{{
<title>Survey of Australian Taxonomic Workforce - Personal Survey</title>
<shortName>Personal Survey</shortName>
}}}

==== Required Role ====

The required role element defines the ALA authorisation that a user requires to carry out the survey.  For example the ABRS Institutional survey requires a user to have ROLE_ABRS_INSTITUTION. A when a user logs into the ABRS Survey web application if they have this authorisation then the ABRS Institutional survey is displayed, otherwise the ABRS Personal survey is displayed.

{{{
<requiredRole>ROLE_ABRS_INSTITUTION</requiredRole>
}}}

==== Page Sequence ====

The pageSequence element defines the pagination of a survey.  Each page sub-element defines which questions appear on that page.

{{{
<pageSequence>
  <page>1-2</page>
  <page>3-3</page>
  <page>4-5</page>
  <page>6-6</page>
    ...
</pageSequence>
}}}

==== Known Questions ====

The knownQuestions element defines the question number of particular survey questions that are referenced by the aggregation and charting components of the application.  Currently only the Personal Survey uses these.

{{{
<knownQuestions>
  <employmentStatus>3</employmentStatus>
  <gender>15</gender>
  <ageGroup>16</ageGroup>
</knownQuestions>
}}}

==== Accounts ====

The accounts element is used by the ABRS Institutional survey to link an ALA user id to an institution and also to link an institutional survey to a natural history collection.  The user element identifies the ALA user associated with the institution and the uid element is the ALA Collections identifier.

{{{
<accounts>
  <account>
    <user>survey@dpi.qld.gov.au</user>
    <institution>Queensland Plant Pathology Herbarium</institution>
    <code>BRIP</code>
    <uid>co53</uid>
  </account>
  ...
</accounts>
}}}

==== Question(s) ====

There must be one or more question elements in a question set. Question elements can nested (to a depth of 3 levels).

The question element can have a number of optional attributes to specify the properties of the question.

|| *Attribute* || *Description* ||
|| instruction || Defines instruction text that is displayed with a question ||
|| instructionPosition || Position of instructions. e.g. 'top', default is 'bottom' ||
|| type || Question type - can be 'rank', 'pick', 'range', 'matrix', 'group' or 'none' ||
|| heightHint || ??? not used ||
|| dependentOn || Question can be dependent on the answer to another question - holds the path and the condition. e.g. 'Q5=yes' ||
|| datatype || Data type of the answer - 'bool', 'number', 'text', 'numberRange', 'rank' or 'integer' ||
|| defaultDataType || Data type applied to child questions ||
|| defaultAnswerType || Answer type applied to child questions - 'bool', 'none', 'number', 'text', 'textarea', 'percent', 'rank', 'externalRef', 'radio', 'range', 'preload', 'calculate' or 'summable' ||
|| defaultLayoutHint || Layout hint for child questions - 'align-with-level3', 'subgroup:Label', 'm/n' ||
|| defaultDisplayHint || Form of display for child questions - 'checkbox', 'combobox', 'noColumnHeadings' or 'n' where n = fieldwidth ||

===== question element =====

{{{
<question>
  <text>...</text>
  [<shortText>...</shortText>]
  [<data>...</data>]
  <answer/> | <question>...</question>
  [<aggregate/>]
</question>
}}}

|| *Element* || *Description* ||
|| text || Question text ||
|| shortText || Optional abbreviated version of question text.  Used in the tabular summary display of a survey's answers ||
|| data || Question data ||